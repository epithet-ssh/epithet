---
title: 'Policy Server - Bearer Auth Header: Update policy server to accept token in Authorization header. Files: pkg/policyserver/policyserver.go, pkg/ca/ca.go, cmd/epithet/policy.go. Policy server extracts token from header, CA passes token in header to policy server, remove token from policy request body.'
id: 2xd411gq
created: 2025-12-14T05:17:19.364276Z
updated: 2025-12-14T05:17:30.186515Z
author: Brian McCallister
priority: medium
tags:
- protocol
- policy-server
blocked_by:
- mc0d1e7n
---

---
## Log

---
# Log: 2025-12-14T05:17:19Z Brian McCallister

Created task.
---
# Log: 2025-12-14T05:17:26Z Brian McCallister

Implementation details:

Policy server side (pkg/policyserver/policyserver.go):
- Parse 'Authorization: Bearer <token>' header
- Token validation happens here (OIDC, etc.)
- Remove token from request body struct

CA calling policy server (pkg/ca/ca.go):
- In RequestPolicy(), set Authorization header when calling policy server
- req.Header.Set("Authorization", "Bearer " + token)
- Remove token from JSON body sent to policy server

Policy request body becomes:
  type PolicyRequest struct {
      Signature  string            `json:"signature"`
      Connection policy.Connection `json:"connection,omitempty"`
  }

Note: Connection is optional - if nil, it's a validation-only request (for hello flow)
---
# Log: 2025-12-14T05:17:30Z Brian McCallister

Added blocker: mc0d1e7n
