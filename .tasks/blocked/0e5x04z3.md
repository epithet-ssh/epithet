---
title: 'CA Client - Bearer Auth Header: Update CA client to send token in Authorization header. Files: pkg/caclient/caclient.go, pkg/caclient/caclient_test.go. Remove Token from request body, set Authorization: Bearer header with base64url encoded token.'
id: 0e5x04z3
created: 2025-12-14T05:18:10.325576Z
updated: 2025-12-14T17:35:51.255969Z
author: Brian McCallister
priority: high
tags:
- protocol
- ca-client
blocked_by:
- qhfqkc0f
---

---
## Log

---
# Log: 2025-12-14T05:18:10Z Brian McCallister

Created task.
---
# Log: 2025-12-14T05:18:16Z Brian McCallister

Implementation details:

In pkg/caclient/caclient.go:

When making requests to CA:
  encoded := base64.RawURLEncoding.EncodeToString(token)
  req.Header.Set("Authorization", "Bearer " + encoded)

Remove Token field from request body struct.

Update CreateCertificate() method:
- Token parameter is []byte (raw)
- Encode to base64url for header
- Don't include in JSON body

Update tests in pkg/caclient/caclient_test.go:
- All test requests should use Authorization header
- Verify header is set correctly
- Verify body doesn't contain token
---
# Log: 2025-12-14T05:18:20Z Brian McCallister

Added blocker: qhfqkc0f
---
# Log: 2025-12-14T17:35:51Z Brian McCallister

CONFIRMED: CA Client (broker->CA) sends user token in Authorization: Bearer header. No change from design decision - this is the inbound side.
